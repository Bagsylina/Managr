@model Managr.Models.Project

@{
    ViewBag.Title = "Show";
}

@if (ViewBag.Message != null)
{
    <div class="alert @ViewBag.Alert p-3 rounded-3 text-center mb-5">
        @ViewBag.Message
    </div>
}

@*
    A prettier Show will be added
*@

<h1 class="alert alert-primary">
    @Model.Name
</h1>

<div>
    @Model.Description
</div>

<br />

<div>
    <div class="alert-dark d-flex justify-content-between">
        <i class="bi bi-gear"></i>
        This project is maintained by
        <i class="bi bi-gear"></i>
    </div>
    <div class="alert-dark d-flex justify-content-between">
        <i class="bi bi-person"></i>
        @Model.Organizer.UserName
        <i class="bi bi-person"></i>
    </div>


    <br />

    @if (ViewBag.UserId == @Model.OrganizerId || ViewBag.IsAdmin)
    {
        TempData["ProjectId"] = Model.Id;
        <div class="d-flex alert-warning flex-column">
            <h3 class="text-success">
                Admin area
            </h3>
            <div class="d-flex justify-content-evenly">
                <a class="btn btn-outline-success" href="/Tasks/New">
                    <i class="bi bi-clipboard-plus"></i>
                    New Task
                </a>
                
                <a class="btn btn-outline-primary" href="/Projects/Edit/@Model.Id">
                    <i class="bi bi-gear"></i>
                    Edit project!
                </a>

                <a class="btn btn-outline-success" href="/Projects/AddMember/@Model.Id">
                    <i class="bi bi-person-plus"></i>
                    Add member
                </a>

                <a class="btn btn-outline-danger" href="/Projects/RemoveMember/@Model.Id">
                    <i class="bi bi-person-dash"></i>
                    Remove member
                </a>
            </div>
        </div>
        <br />
    }
</div>

<br />

<form method="GET">
    <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Search topics or keywords" name="search" value="@ViewBag.SearchString">
        <button class="btn btn-outline-success" type="submit">Search Task</button>
    </div>
</form>

<br />

@foreach (var task in ViewBag.Tasks)
{
    <div class="card">
        <div class="card-body">
            <h3 class="card-title alert-success py-3 px-3 rounded-2">@task.Title</h3>
            @*<p class="card-text">@task.Description</p>*@

            <div class="d-flex justify-content-between flex-row mt-5">

                @if (task.Status == "Not Started")
                {
                    <span class="alert-danger px-1 align-content-center">@task.Status</span>
                }
                @if (task.Status == "In Progress" || task.Status == "On Hold")
                {
                    <span class="alert-warning px-1 align-content-center">@task.Status</span>
                }
                @if (task.Status == "Completed")
                {
                    <span class="alert-success px-1 align-content-center">@task.Status</span>
                }

                <span class="alert-info px-1 align-content-center">@task.StartDate</span>
                <span class="alert-danger px-1 align-content-center">@task.Deadline</span>

                <a href="/Tasks/Show/@task.Id" class="btn btn-outline-success">Show Task</a>

            </div>
        </div>
    </div>
    <br/>
}